<!DOCTYPE html>
<html>
<head>
    <title>Meal & Travel Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', Arial, sans-serif;
            max-width: 900px;
            margin: auto;
            padding: 20px;
            background: url('https://images.unsplash.com/photo-1467003909585-2f8a72700288?auto=format&fit=crop&w=1200&q=80') no-repeat center center fixed;
            background-size: cover;
            color: #333;
        }
        h1, h2 {
            text-align: center;
            color: #fff8f0;
            text-shadow: 0 2px 8px #8b451350;
            font-weight: 700;
        }
        .section {
            background: rgba(255, 255, 255, 0.88);
            border-radius: 12px;
            box-shadow: 0 2px 12px #dc662180;
            padding: 20px;
            margin-bottom: 30px;
        }
        label { font-weight: 700; margin-top: 10px; display: block; }
        input, select, textarea {
            width: 100%; padding: 7px; font-size: 15px;
            margin-top: 5px; border-radius: 6px; border: 1px solid #ffa044;
            box-sizing: border-box; font-family: inherit;
        }
        textarea { resize: vertical; }
        button {
            background: #ffad60; color: white; border: none; padding: 10px 18px;
            font-size: 16px; border-radius: 6px; cursor: pointer; margin-top: 15px;
            transition: background 0.3s; font-family: inherit; font-weight: 700;
        }
        button:hover { background: #ef6c18; }
        table {
            border-collapse: collapse; width: 100%; margin-top: 20px;
            background: #fff2e1; border-radius: 10px; overflow: hidden; font-family: inherit;
        }
        th, td {
            border: 1px solid #eecda3; padding: 10px; text-align: center; vertical-align: middle;
            word-wrap: break-word;
        }
        th { background: #ffc47c; }
        .action-btn {
            margin: 2px; padding: 6px 12px; font-size: 14px;
            border-radius: 6px; border: none; cursor: pointer;
            font-family: inherit; font-weight: 700;
        }
        .edit-btn { background-color: #f0ad4e; color: white; }
        .delete-btn { background-color: #d9534f; color: white; }
        .update-btn { background-color: #5cb85c; color: white; }
        .cancel-btn { background-color: #777; color: white; }
        .group-title { background: #ffe8c3; font-weight: 700; color: #c47c00; }
        @media(max-width:700px) {
            body { padding: 10px; }
            button, input, select, textarea { font-size: 14px; }
            th, td { font-size: 13px; padding: 6px; }
        }
    </style>
</head>
<body>

    <h1>Meal & Travel Tracker</h1>

    <!-- Meal Entry -->
    <div class="section" id="meal-section">
        <h2>Meal Entry</h2>
        <label for="meal-date">Select Date:</label>
        <input type="date" id="meal-date">

        <label>Place</label>
        <select id="meal-place">
            <option value="">-- Select --</option>
            <option value="Local">Local</option>
            <option value="Outstation">Outstation</option>
        </select>

        <label>Breakfast</label>
        <input type="text" id="breakfast">

        <label>Lunch</label>
        <input type="text" id="lunch">

        <label>Dinner</label>
        <input type="text" id="dinner">

        <label>Remarks</label>
        <textarea id="meal-remarks"></textarea>

        <button onclick="saveMeal()">Add Meal Entry</button>
    </div>

    <!-- Travel Entry -->
    <div class="section" id="travel-section">
        <h2>Travel Expense Entry</h2>
        <label for="travel-date">Select Date:</label>
        <input type="date" id="travel-date">

        <label>Place</label>
        <select id="travel-place">
            <option value="">-- Select --</option>
            <option value="Local">Local</option>
            <option value="Outstation">Outstation</option>
        </select>

        <label>Transport Mode</label>
        <select id="transport-mode">
            <option value="">-- Select Mode --</option>
            <option value="Bus">Bus</option>
            <option value="Auto">Auto</option>
            <option value="Cab">Cab</option>
            <option value="Train">Train</option>
        </select>

        <label>Amount (₹)</label>
        <input type="text" id="travel-amount">

        <label>Remarks</label>
        <textarea id="travel-remarks"></textarea>

        <button onclick="saveTravel()">Add Travel Entry</button>
    </div>

    <!-- Meal Records -->
    <div class="section">
        <h2>Meal Records</h2>
        <label>Filter:</label>
        <select id="meal-filter" onchange="renderMealTable()">
            <option value="All">All</option>
            <option value="Local">Local</option>
            <option value="Outstation">Outstation</option>
        </select>
        <table id="mealTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Place</th>
                    <th>Breakfast</th>
                    <th>Lunch</th>
                    <th>Dinner</th>
                    <th>Remarks</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- Travel Records -->
    <div class="section">
        <h2>Travel Records</h2>
        <label>Filter:</label>
        <select id="travel-filter" onchange="renderTravelTable()">
            <option value="All">All</option>
            <option value="Local">Local</option>
            <option value="Outstation">Outstation</option>
        </select>
        <table id="travelTable">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Place</th>
                    <th>Transport Mode</th>
                    <th>Amount (₹)</th>
                    <th>Remarks</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="section" style="text-align:center;">
        <button onclick="exportData()">⬇️ Export All Records (CSV)</button>
    </div>

<script>
    let mealData = JSON.parse(localStorage.getItem('mealData')) || {};
    let travelData = JSON.parse(localStorage.getItem('travelData')) || {};
    let editMealKey=null, editMealIndex=null, editTravelKey=null, editTravelIndex=null;

    function saveMeal() {
        const date=document.getElementById('meal-date').value;
        const place=document.getElementById('meal-place').value;
        const breakfast=document.getElementById('breakfast').value.trim();
        const lunch=document.getElementById('lunch').value.trim();
        const dinner=document.getElementById('dinner').value.trim();
        const remarks=document.getElementById('meal-remarks').value.trim();
        if(!date||!place){alert("Please select date and place!");return;}
        if(!mealData[date]) mealData[date]=[];
        mealData[date].push({place,breakfast,lunch,dinner,remarks});
        localStorage.setItem('mealData',JSON.stringify(mealData));
        renderMealTable(); clearMealInputs();
    }
    function renderMealTable() {
        const filter=document.getElementById('meal-filter').value;
        const tbody=document.querySelector('#mealTable tbody'); tbody.innerHTML='';
        const dates=Object.keys(mealData).sort().reverse();
        for(const date of dates){
            for(let i=0;i<mealData[date].length;i++){
                const m=mealData[date][i];
                if(filter!=="All" && m.place!==filter) continue;
                tbody.innerHTML+=`
                    <tr>
                        <td>${date}</td>
                        <td>${m.place}</td>
                        <td>${m.breakfast||''}</td>
                        <td>${m.lunch||''}</td>
                        <td>${m.dinner||''}</td>
                        <td>${m.remarks||''}</td>
                        <td>
                            <button class="action-btn edit-btn" onclick="editMeal('${date}',${i})">Edit</button>
                            <button class="action-btn delete-btn" onclick="deleteMeal('${date}',${i})">Delete</button>
                        </td>
                    </tr>`;
            }
        }
    }
    function editMeal(date,i){editMealKey=date;editMealIndex=i;/* implement editing same as before */}
    function deleteMeal(date,i){mealData[date].splice(i,1);if(!mealData[date].length) delete mealData[date];localStorage.setItem('mealData',JSON.stringify(mealData));renderMealTable();}
    function clearMealInputs(){document.getElementById('meal-place').value='';document.getElementById('breakfast').value='';document.getElementById('lunch').value='';document.getElementById('dinner').value='';document.getElementById('meal-remarks').value='';}

    function saveTravel(){
        const date=document.getElementById('travel-date').value;
        const place=document.getElementById('travel-place').value;
        const mode=document.getElementById('transport-mode').value;
        const amount=document.getElementById('travel-amount').value.trim();
        const remarks=document.getElementById('travel-remarks').value.trim();
        if(!date||!place||!mode||!amount||isNaN(amount)){alert("Fill all travel details correctly!");return;}
        if(!travelData[date]) travelData[date]=[];
        travelData[date].push({place,mode,amount,remarks});
        localStorage.setItem('travelData',JSON.stringify(travelData));
        renderTravelTable(); clearTravelInputs();
    }
    function renderTravelTable(){
        const filter=document.getElementById('travel-filter').value;
        const tbody=document.querySelector('#travelTable tbody'); tbody.innerHTML='';
        const dates=Object.keys(travelData).sort().reverse();
        for(const date of dates){
            let total=0;
            for(let i=0;i<travelData[date].length;i++){
                const t=travelData[date][i];
                if(filter!=="All" && t.place!==filter) continue;
                total+=Number(t.amount);
                tbody.innerHTML+=`
                    <tr>
                        <td>${date}</td>
                        <td>${t.place}</td>
                        <td>${t.mode}</td>
                        <td>₹${t.amount}</td>
                        <td>${t.remarks||''}</td>
                        <td>
                            <button class="action-btn edit-btn" onclick="editTravel('${date}',${i})">Edit</button>
                            <button class="action-btn delete-btn" onclick="deleteTravel('${date}',${i})">Delete</button>
                        </td>
                    </tr>`;
            }
            if(total>0) tbody.innerHTML+=`<tr><td colspan="3"><b>Total</b></td><td colspan="3"><b>₹${total}</b></td></tr>`;
        }
    }
    function editTravel(date,i){editTravelKey=date;editTravelIndex=i;/* implement editing */}
    function deleteTravel(date,i){travelData[date].splice(i,1);if(!travelData[date].length) delete travelData[date];localStorage.setItem('travelData',JSON.stringify(travelData));renderTravelTable();}
    function clearTravelInputs(){document.getElementById('travel-place').value='';document.getElementById('transport-mode').value='';document.getElementById('travel-amount').value='';document.getElementById('travel-remarks').value='';}

    function exportData(){
        let csv="Section,Date,Place,Breakfast,Lunch,Dinner,Meal Remarks,Transport Mode,Amount,Travel Remarks\n";
        for(const date in mealData){for(const m of mealData[date]){csv+=`Meal,${date},${m.place},${m.breakfast||''},${m.lunch||''},${m.dinner||''},${m.remarks||''},,,\n`;}}
        for(const date in travelData){for(const t of travelData[date]){csv+=`Travel,${date},${t.place},,,,,${t.mode},${t.amount},${t.remarks||''}\n`;}}
        const blob=new Blob([csv],{type:"text/csv"});const url=URL.createObjectURL(blob);const a=document.createElement("a");a.href=url;a.download="meal_travel_records.csv";a.click();
    }

    renderMealTable(); renderTravelTable();
</script>
</body>
</html>
